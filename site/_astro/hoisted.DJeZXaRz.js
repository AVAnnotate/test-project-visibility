import"./hoisted.adF1pggN.js";import{$ as i}from"./store.aycOQVLs.js";const c=o=>{o.classList.add("hidden"),o.classList.remove("flex")},p=o=>{o.classList.add("flex"),o.classList.remove("hidden")},y="!bg-blue-hover",m=document.querySelectorAll(".playAnnotation");for(let o=0;o<m.length;o++){const n=m[o];if(n.dataset.start&&n.dataset.playerId){const e=i.get()[n.dataset.playerId]?.annotationStarts;e&&(e.push({start:Math.floor(Number(n.dataset.start)),end:Math.floor(Number(n.dataset.end))>Math.floor(Number(n.dataset.start))?Math.floor(Number(n.dataset.end)):void 0}),i.setKey(n.dataset.playerId,{...i.get()[n.dataset.playerId],annotationStarts:e})),n.addEventListener("click",()=>{const r=n.dataset.playerId||"null";i.setKey(r,{...i.get()[r],position:Number(n.dataset.start),seekTo:Number(n.dataset.start),isPlaying:!0})})}}i.listen((o,n,e)=>{if(!e)return null;const r=document.querySelector(`.eventContainer[data-player-id="${e}"]`);if(!r)return console.error(`No event container found for ${e}`),null;const a=r.querySelectorAll(".annotationNode"),d=r.querySelectorAll(".annotationTags"),f=o[e].annotationStarts,u=f?.findIndex((t,s)=>typeof t.end=="number"?t.start<=o[e].position&&t.end>o[e].position:s<f.length-1?t.start<=o[e].position&&f[s+1].start>o[e].position:t.start<=o[e].position);if(typeof u=="number"&&u>=0){const t=a[u];if(o[e].autoScroll)if(o[e].isEmbed){const s=document.querySelector(`.videoAnnotationContainer[data-player-id="${e}"]`),l=t.offsetTop;s?s.scroll({top:l-s.clientHeight,behavior:"smooth"}):r.scroll({top:l-r.clientHeight/3,behavior:"smooth"})}else t.scrollIntoView({behavior:"smooth",block:"end"});t.classList.add(y);for(let s=0;s<a.length;s++)s!==u&&a[s].classList.remove(y)}if(o[e].showTags!==n[e].showTags)if(o[e].showTags)for(let t=0;t<d.length;t++)p(d[t]);else for(let t=0;t<d.length;t++)c(d[t]);for(let t=0;t<a.length;t++){const l=a[t].getAttribute("data-uuid");l&&o[e].filteredAnnotations.includes(l)?p(a[t]):c(a[t])}});
